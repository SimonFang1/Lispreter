
<!-- saved from url=(0086)file:///G:/ccf/2017%20ccsp/problems/TUOJ.%E6%9F%A5%E7%9C%8B%E9%A2%98%E7%9B%AE2.html#!/ -->
<html ng-app="tuoj-web" class="ng-scope"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style><style type="text/css">@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>
		
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<link rel="stylesheet" href="./Lisp_files/bootstrap.min.css">
		<link rel="stylesheet" href="./Lisp_files/atom-one-light.css">
		<link rel="stylesheet" href="./Lisp_files/style.css">
		<link rel="stylesheet" href="./Lisp_files/jquery.dataTables.min.css">
		<link rel="icon shortcut" href="https://ccsp.cspro.org/images/favicon.png" type="image/png">
		<script src="./Lisp_files/jquery.min.js.下载"></script>
		<script src="./Lisp_files/bootstrap.min.js.下载"></script>
		<script src="./Lisp_files/jquery.dataTables.min.js.下载"></script>
		<script src="./Lisp_files/lib.angular.js.下载"></script>
		<script src="./Lisp_files/controller.js.下载"></script>
		<script src="./Lisp_files/router.js.下载"></script>
		<title class="ng-binding">TUOJ.查看题目</title><script src="./Lisp_files/marked.js.下载" async=""></script><script src="./Lisp_files/MathJax.js.下载" async=""></script>
	<style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><script src="file:///G:/bower_components/marked/lib/marked.js" async=""></script><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style></head>
	<body><div id="MathJax_Message" style="display: none;"></div><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div></div><div id="MathJax_Message" style="display: none;"></div>
		<!-- ngInclude: --><!-- ngInclude: -->
		<!-- uiView: --><!-- uiView: --><div ui-view="" class="container ng-scope"><!-- ngIf: contestInfo.func==="contest" --><!-- ngIf: contestInfo.func==="contest" --><!-- end ngIf: contestInfo.func==="contest" -->

<!-- uiView: --><!-- uiView: --><div ui-view="" class="ng-scope"><div class="page-header ng-scope">
	<h1 class="ng-binding">Lisp</h1>
</div>
<div class="row ng-scope">
	<div class="col-md-8 col-sm-12">
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="pull-right">
					<button class="btn btn-default">
						<i class="glyphicon glyphicon-refresh" ng-click="fetchData()"></i>
					</button>
					<!--<button class='btn btn-default'>
						 <i class='glyphicon glyphicon-fullscreen' ng-click='changeLR()'></i>
					</button>-->
				</div>
				<div id="problemtext" style="display: block;"><p><strong>时间限制：</strong> 1.0 秒 </p>
<p><strong>空间限制：</strong> 128 MB</p>
<p><strong>相关文件：</strong> 题目目录</p>
<h2 id="-">题目背景</h2>
<p>Lisp 语言由 John McCarthy 教授（1927-2011，1971 年图灵奖得主）发明于 1958 年，是现今还在使用的第二古老的高级语言（最古老的是 Fortran，比 Lisp 发明还早一年）。Lisp 的语法与常见的编程语言很不一样，Lisp 程序由很多列表组成，Lisp 也得名于<strong>列表处理器（List Processor）</strong>。</p>
<p>本题的任务是编写一个列表处理器，实现 Lisp 语言的基本功能（当然你可以把它看作是 Lisp 语言的一个简化版本）。输入是一段 Lisp 程序，输出是这个程序的运行结果。下面将详细的介绍需要实现的功能。</p>
<h2 id="-">题目描述</h2>
<p>Lisp 是一种函数式编程语言，每一个表达式都可以计算出一个结果。Lisp 表达式有两种形式——<strong>原子</strong>或<strong>列表</strong>。所谓原子，简单的讲就是一个字符串，可以使用的字符有大小写英文字母、数字和 <code>+-*/!?=&lt;&gt;_</code> ；而列表则是由若干个表达式和一对括号在两侧括起构成。</p>
<p>原子的例子：</p>
<pre><code>12
+
John
Burger
</code></pre><p>上面给出了一些原子的例子。 <code>12</code> 就是一个整数，就像其他编程语言中的 <code>int</code> 一样，但后面三个却略有不同。在 Lisp 中，这些含有非数字字符的原子被称作<strong>标识符</strong>。实际上每一个标识符都指代了一个值，不过有些标识符对应的值 Lisp 已经自动绑定好了，比如 <code>+</code> 指代加法函数，而更多的标识符需要在程序中人为地指定一个值。下面则是几个列表的例子。在书写格式上，列表中的每两个表达式由一个空格分隔，左右再加一对圆括号括起。</p>
<p>列表的例子：</p>
<pre><code>(f a b c)
(define x (+ 2 3))
(+ 1 1)
</code></pre><p>在 Lisp 中，函数的使用是通过列表来完成的。通常使用圆括号时，会把列表中的第一个表达式的值默认为是一个函数，后面表达式的值则被视为传入该函数的参数，而函数的返回值就是整个表达式的值。所以 <code>(+ 1 2)</code> 就代表了 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1000.41em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: STIXGeneral;">1</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">1</script> 和 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1000.53em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mn" id="MathJax-Span-6" style="font-family: STIXGeneral;">2</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">2</script> 做加法运算，该表达式的结果显然为 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-7" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1000.47em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mn" id="MathJax-Span-9" style="font-family: STIXGeneral;">3</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">3</script> 。</p>
<pre><code>(+ 1 2)        //表示1和2做加法运算，结果为3。
(+ (* 5 2) 3)    //先计算5乘2，结果为10；再与3相加，最终结果为13。
</code></pre><p>在本题中，基本的函数有四个：加减乘除（整除），分别用标识符表示 <code>+</code> 、 <code>-</code> 、 <code>*</code> 、 <code>/</code> 指代。而我们要处理的数字（包括运算的中间结果），也都是小于等于 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-10" style="width: 1.759em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.408em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.056em 1001.41em 1.174em -999.997em); top: -0.992em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="msubsup" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 1.408em; height: 0px;"><span style="position: absolute; clip: rect(3.106em 1001em 4.16em -999.997em); top: -3.978em; left: 0em;"><span class="mn" id="MathJax-Span-13" style="font-family: STIXGeneral;">10</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.998em;"><span class="mn" id="MathJax-Span-14" style="font-size: 70.7%; font-family: STIXGeneral;">9</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">10^9</script> 的自然数，且保证整除运算第二个参数不为 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-15" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1000.53em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-16"><span class="mn" id="MathJax-Span-17" style="font-family: STIXGeneral;">0</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">0</script> 。我们的列表处理器同样支持布尔类型，分别用标识符 <code>True</code> 和 <code>False</code> 指代逻辑值真和假。此外还有一些 Lisp 预先定义好的函数，我们将在下面逐一介绍。</p>
<h3 id="eq-">eq?</h3>
<p>判断两个整数或两个逻辑值是否相等。如果相等返回 <code>True</code> ，否则返回 <code>False</code> 。
两个参数的值 <strong>或者同为整数</strong>，<strong>或者同为逻辑值</strong>。</p>
<pre><code>(eq? 1 1)        //True
(eq? 4 (+ 1 2))        //False
(eq? (eq? 1 2) False)     //True
</code></pre><h3 id="define">define</h3>
<p>这是唯一一个没有返回值的函数，所以它不能被嵌套在列表之中。它的作用是为标识符绑定一个值。要求每个标识符只能被绑定一次，Lisp 自带的标识符相当于已经被绑定过一次，所以不能再成为 <code>define</code> 函数的第一个参数。</p>
<pre><code>(define a 5)        //a的值绑定为5
(define add +)        //add的值绑定为加法函数
</code></pre><h3 id="lambda">lambda</h3>
<p>返回一个新定义的函数。
第一个参数是一个由若干个（至少一个）标识符构成的列表，表示新函数的参数列表，这些标识符做为新函数的参数仅在第二个参数中有效。需要注意的是，这里虽然也使用了列表的形式，但无需进行函数运算。</p>
<p>第二个参数表示新函数的返回值。在第二个参数中使用的标识符有两种情况，一种是通过 <code>define</code> 定义的标识符，一种是做为新函数参数的标识符。因为在定义函数时并不需要进行具体计算，我们要做的只是把它先存储下来，所以在第二个参数中可以使用暂时还没有绑定过值的标识符，只要保证在使用该函数进行计算时每个标识符都已经绑定了值即可。另一方面， <code>lambda</code> 表达式可以嵌套使用，这就导致了在第二个参数中使用的标识符也可能是外层函数的参数。为避免歧义，Lisp对标识符的取值采取就近原则，即优先解释为较近层的函数参数；如果在任何一层的参数列表中都找不到这个标识符，就采用 <code>define</code> 表达式绑定的值。</p>
<p>此外，一个单独的 <code>lambda</code> 表达式没有任何意义。在Lisp中，一个值为函数的表达式一定被嵌套在列表之中：或者在 <code>define</code> 函数中使用，或者做为一个匿名函数直接参与运算。</p>
<pre><code>(define add3 (lambda (x y z) (+ (+ x y) z)))    //定义了一个将三个参数相加的函数add3；
((lambda (+ -) (* + -)) 2 3)            //这里用匿名函数的形式定义了乘法函数，然后计算2乘3；
(add3 2 3 4)                    //使用刚刚定义的add3函数，结果为9。
</code></pre><h3 id="cond">cond</h3>
<p>选择函数，参数个数不定但至少为 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-18" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.53em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1000.53em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-19"><span class="mn" id="MathJax-Span-20" style="font-family: STIXGeneral;">2</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">2</script> ，其中每个参数都是一个由两个表达式构成的列表，且第一个表达式的值一定是逻辑类型（真或假）。类似地，这里的列表也不起函数计算作用。</p>
<p><code>cond</code> 函数会依次检查每个参数的第一个表达式，如果值为真，则将第二个表达式的值返回，并且不再继续检查后面的参数。</p>
<pre><code>(cond ((eq? a 2) 0) ((eq? a 3) 1) (True 2))    //a等于2时返回0，等于3时返回1，其它情况返回2。
</code></pre><p>保证每个 <code>cond</code> 函数至少存在至少一个参数，其第一个表达式为真。</p>
<h2 id="-">输入格式</h2>
<p>从标准输入读入数据。</p>
<p>一段 Lisp 程序，其中每行是一个表达式。</p>
<p>保证程序格式正确无误，运行时不会出现任何异常（每个函数都一定会有返回值、进行计算时不会遇到无法解释的标识符等等）。</p>
<h2 id="-">输出格式</h2>
<p>输出到标准输出。</p>
<p>对于 Lisp 程序中每一行的表达式，相应输出一行。</p>
<p>如果该表达式使用了 <code>define</code> 函数则输出 <code>define</code> ，否则输出该表达式的值。</p>
<h2 id="-1-">样例1输入</h2>
<pre><code>(define y 10)
(define f (lambda (x y) (+ x ((lambda (x) (* x y)) y))))
(f 1 2)
y
</code></pre><h2 id="-1-">样例1输出</h2>
<pre><code>define
define
5
10
</code></pre><h2 id="-1-">样例1解释</h2>
<p>定义了一个二元函数： <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-21" style="width: 9.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.439em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1007.44em 2.93em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23" style="font-family: STIXGeneral; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mrow" id="MathJax-Span-24" style="padding-left: 0.179em;"><span class="mo" id="MathJax-Span-25" style="vertical-align: 0em;"><span style="font-family: STIXGeneral;">(</span></span><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-28" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-29" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.179em;">y</span></span><span class="mo" id="MathJax-Span-30" style="vertical-align: 0em;"><span style="font-family: STIXGeneral;">)</span></span></span><span class="mo" id="MathJax-Span-31" style="font-family: STIXGeneral; padding-left: 0.296em;">=</span><span class="mi" id="MathJax-Span-32" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.296em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-33" style="font-family: STIXGeneral; padding-left: 0.237em;">+</span><span class="mi" id="MathJax-Span-34" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.237em;">y</span><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral; padding-left: 0.237em;">×</span><span class="mi" id="MathJax-Span-36" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.237em;">y</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">f \left(x, y\right) = x + y \times y</script>。</p>
<h2 id="-2-">样例2输入</h2>
<pre><code>(define y 10)
(define sqr+y (lambda (x) (+ y (* x x))))
(define f (lambda (x y) (sqr+y x)))
(sqr+y 5)
(f 5 1)
</code></pre><h2 id="-2-">样例2输出</h2>
<pre><code>define
define
define
35
35
</code></pre><h2 id="-2-">样例2解释</h2>
<p><code>f</code> 函数的参数 <code>y</code> 并不能在 <code>sqr+y</code> 函数中起作用，即使 <code>f</code> 调用了 <code>sqr+y</code> 。</p>
<h2 id="-3-">样例3输入</h2>
<pre><code>(define fact (lambda (n) (cond ((eq? n 1) 1) (True (* n (fact (- n 1)))))))
(fact 1)
(fact 5)
(fact 10)
(define sum (lambda (n) (cond ((eq? n 1) 1) (True (+ n (sum (- n 1)))))))
(sum 50)
</code></pre><h2 id="-3-">样例3输出</h2>
<pre><code>define
1
120
3628800
define
1275
</code></pre><h2 id="-4-">样例4输入</h2>
<pre><code>(define fun1 (lambda (x) (cond ((eq? x 0) 1) (True (fun2 (- x 1))))))
(define fun2 (lambda (x) (cond ((eq? x 0) 2) (True (fun1 (/ x 2))))))
(fun1 2)
(fun2 2)
(fun1 5)
(fun2 5)
</code></pre><h2 id="-4-">样例4输出</h2>
<pre><code>define
define
1
2
1
1
</code></pre><h2 id="-5-">样例 5 输入</h2>
<pre><code>(define 33g (lambda (x1 x2 x3 x4) ((lambda (x1 x2) ((lambda (x1 x2 x3) (+ x4 (+ x1 ((lambda (x4 x1) (+ (* x4 x3) (* x1 x1))) x2 x3)))) x2 x3 0alpha)) x1 x3)))
(define 0alpha 666)
(33g 1 2 3 4)
(33g 2 4 6 8)
(33g 0 0 0 0)
(define 666kk (lambda (x1) (lambda (x2 x3) (+ x1 (+ x2 x3)))))
((666kk 10) 20 30)
</code></pre><h2 id="-5-">样例 5 输出</h2>
<pre><code>define
define
445561
447566
443556
define
60
</code></pre><h2 id="-">提示</h2>
<p>针对题意有些疑问的地方，我们统一在这里做出进一步的说明。</p>
<p>在本题中，一个表达式的值有且仅有三种可能：整数，逻辑值（ <code>True</code> 或
 <code>False</code> ）和函数，<strong>传给函数的参数</strong>和<strong>函数返回值</strong>的类型可能是其中的任意一种。对于Lisp内置的函数，加减乘除函数的参数只能是整数， <code>eq?</code> 和 <code>cond</code> 等的参数要求如题面所述。</p>
<p>用 <code>lambda</code> 表达式定义函数 <code>f1</code> 时，如果在<strong>参数一</strong>中定义了标识符 <code>x</code> ，那么这个 <code>x</code> 仅在<strong>后面</strong>表示返回值的<strong>参数二</strong>中起作用。如果<strong>参数二</strong>调用了在别的地方定义的函数 <code>f2</code> ，我们认为<strong>参数二</strong>只是使用了那个函数的函数名 <code>f2</code> ，函数 <code>f2</code>的返回值部分不会被算做在 <code>f1</code> 的<strong>参数二</strong>里，自然 <code>x</code> 就不会在 <code>f2</code> 中生效了。换言之，作用范围只考虑定义时书写上的关系，而不考虑运行时的调用关系。样例 2 恰好说明了这个问题。另一个类似的例子：在C语言中，即使 <code>a</code> 函数调用了 <code>b</code> 函数， <code>a</code> 中定义的变量同样也不能在 <code>b</code> 中起作用。</p>
<h2 id="-">子任务</h2>
<p>前 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-37" style="width: 2.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1001.7em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="mn" id="MathJax-Span-39" style="font-family: STIXGeneral;">30</span><span class="mi" id="MathJax-Span-40" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">30\%</script> 的数据，没有 <code>lambda</code> 函数；</p>
<p>前 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-41" style="width: 2.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1001.7em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="mn" id="MathJax-Span-43" style="font-family: STIXGeneral;">60</span><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">60\%</script> 的数据， <code>lambda</code> 函数不会嵌套出现；</p>
<p>对于 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-45" style="width: 2.755em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.228em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1002.17em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="mn" id="MathJax-Span-47" style="font-family: STIXGeneral;">100</span><span class="mi" id="MathJax-Span-48" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">100\%</script> 的数据，输入程序的行数小于等于 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-49" style="width: 1.876em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.525em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1001.52em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-50"><span class="mn" id="MathJax-Span-51" style="font-family: STIXGeneral;">200</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">200</script> ，每一行不多于 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-52" style="width: 1.876em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.525em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1001.52em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-53"><span class="mn" id="MathJax-Span-54" style="font-family: STIXGeneral;">200</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">200</script> 个字符（换行符不计），且函数调用时深度不会超过 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-55" style="width: 1.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1001em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-56"><span class="mn" id="MathJax-Span-57" style="font-family: STIXGeneral;">50</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">50</script> 。调用 Lisp 自带函数和匿名定义的函数不计入函数调用深度，样例3中计算 <code>sum(50)</code> 时函数调用深度恰好为 <span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-58" style="width: 1.232em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em 1001em 2.696em -999.997em); top: -2.515em; left: 0em;"><span class="mrow" id="MathJax-Span-59"><span class="mn" id="MathJax-Span-60" style="font-family: STIXGeneral;">50</span></span><span style="display: inline-block; width: 0px; height: 2.52em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">50</script> 。</p>
</div>
			</div>
		</div>
		<!-- ngIf: needReload -->
		<!-- ngIf: submittable --><!-- ngIf: submittable --><!-- end ngIf: submittable -->	
		<!-- ngIf: langs && langs[0] --><!-- ngIf: langs && langs[0] --><!-- end ngIf: langs && langs[0] -->
		<!-- ngIf: cases && cases[0] && 0 -->
	</div>
	<div class="col-md-4 col-sm-12">
		<div class="panel panel-default">
			<div class="panel-heading">
				<p> 递交历史 </p>
			</div>
			<div class="panel-body">
				<div id="abcd_wrapper" class="dataTables_wrapper no-footer"><table id="abcd" class="table table-hover table-striped dataTable no-footer" role="grid">
					<thead>
						<tr role="row"><th class="sorting_desc" tabindex="0" aria-controls="abcd" rowspan="1" colspan="1" aria-sort="descending" aria-label="#: activate to sort column ascending">#</th><th class="sorting" tabindex="0" aria-controls="abcd" rowspan="1" colspan="1" aria-label="状态: activate to sort column ascending">状态</th><th class="sorting" tabindex="0" aria-controls="abcd" rowspan="1" colspan="1" aria-label="时间: activate to sort column ascending">时间</th></tr></thead>
					<tbody>
						<!-- ngRepeat: status in historys -->
					<tr class="odd"><td valign="top" colspan="3" class="dataTables_empty">No data available in table</td></tr></tbody>
				</table><div class="dataTables_paginate paging_numbers" id="abcd_paginate"><span></span></div></div>
			</div>
		</div>
	</div>
</div>
</div>
</div>
		<div class="container">
			<div style="min-height: 60%"></div>
			<div class="wrapper">
				<hr>
				<p>© 2017 中国计算机学会</p>
			</div>
		</div>
	

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>